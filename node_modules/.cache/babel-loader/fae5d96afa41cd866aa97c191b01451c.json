{"remainingRequest":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\babel-loader\\lib\\index.js!E:\\项目\\SKWMS\\wms-ui\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\项目\\SKWMS\\wms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\项目\\SKWMS\\wms-ui\\src\\components\\page-content\\stock-trans\\dialog\\TransMoveListDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\项目\\SKWMS\\wms-ui\\src\\components\\page-content\\stock-trans\\dialog\\TransMoveListDialog.vue","mtime":1585370815984},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport TablePanel from \"@/components/layout-component/TablePanel\";\nimport ElButtonMini from \"@/components/common/button/ElButtonMini\";\nimport Api from \"@/assets/api/Api\";\nimport ElButtonCurdGroup from \"@/components/common/button/ElButtonCurdGroup\";\nimport DialogUtil from \"@/util/DialogUtil\";\nimport MoveAddDialog from \"@/components/page-content/stock-entry/dialog/MoveAddDialog\";\nimport StockTransModel from \"@/project/model/StockTransModel\";\nimport TransMoveAddDialog from \"@/components/page-content/stock-trans/dialog/TransMoveAddDialog\";\nexport default {\n  name: \"TransMoveListDialog\",\n  components: {\n    TransMoveAddDialog: TransMoveAddDialog,\n    MoveAddDialog: MoveAddDialog,\n    ElButtonCurdGroup: ElButtonCurdGroup,\n    ElButtonMini: ElButtonMini,\n    TablePanel: TablePanel\n  },\n  props: {\n    visible: {\n      default: false\n    },\n    stockTrans: {\n      default: function _default() {\n        return new StockTransModel();\n      }\n    },\n    type: {\n      default: 1\n    }\n  },\n  data: function data() {\n    return {\n      loading: false,\n      showAddDialog: false,\n      data: [],\n      selectedRow: [],\n      editId: 0\n    };\n  },\n  mounted: function mounted() {\n    this.reload();\n  },\n  methods: {\n    reload: function reload() {},\n    showDialog: function showDialog(v) {\n      this.$emit(\"update:visible\", v);\n    },\n    refreshData: function refreshData() {\n      var _this = this;\n\n      this.loading = true;\n      this.$ajax.request(Api.move.selectByStockTransId, {\n        stockTransId: this.stockTrans.id\n      }).then(function (resp) {\n        _this.data = resp;\n      }).finally(function () {\n        return _this.loading = false;\n      });\n    },\n    clickAddButton: function clickAddButton() {\n      this.editId = 0;\n      this.showAddDialog = true;\n    },\n    clickEditButton: function clickEditButton() {\n      this.editId = this.selectedRow[0].id;\n      this.showAddDialog = true;\n    },\n    clickDeleteButton: function clickDeleteButton() {\n      this.delete(this.selectedRow);\n    },\n    clickRowEditButton: function clickRowEditButton(row) {\n      this.editId = row.id;\n      this.showAddDialog = true;\n    },\n    clickRowDeleteButton: function clickRowDeleteButton(row) {\n      this.delete([row]);\n    },\n    delete: function _delete(nodes) {\n      var _this2 = this;\n\n      DialogUtil.confirm(\"\\n                \\u786E\\u5B9A\\u5220\\u9664\\u4EE5\\u4E0B\".concat(this.typeText, \"\\u4FE1\\u606F\\u5417\\uFF1F <br>\\n                [ \").concat(nodes.map(function (x) {\n        return x.materialName;\n      }).join(','), \" ]\\n            \")).then(function () {\n        return _this2.$ajax.request(Api.move.delete, {\n          ids: nodes.map(function (x) {\n            return x.id;\n          }).join(',')\n        });\n      }).then(function (resp) {\n        DialogUtil.toastSuccess(resp);\n\n        _this2.refreshData();\n      });\n    },\n    stockText: function stockText(row) {\n      var isTo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var k = isTo ? 'To' : '';\n      return [row['warehouseCode' + k], row['reservoirCode' + k], row['stockCode' + k] + \"(\".concat(row['stockName' + k], \")\")].join(' / ');\n    }\n  },\n  watch: {\n    visible: function visible(v) {\n      if (v) {\n        this.refreshData();\n      }\n    }\n  },\n  computed: {\n    title: function title() {\n      return \"\".concat(this.typeText, \"\\u5355\\u660E\\u7EC6 \").concat(this.stockTrans.number);\n    },\n    typeText: function typeText() {\n      return \"移位\";\n    },\n    canEdit: function canEdit() {\n      return [1, 4].includes(this.stockTrans.status);\n    }\n  }\n};",{"version":3,"sources":["TransMoveListDialog.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div class=\"TransMoveListDialog\">\r\n        <el-dialog\r\n                width=\"1000px\"\r\n                :visible=\"visible\"\r\n                @update:visible=\"showDialog\"\r\n                :title=\"title\"\r\n                @closed=\"$emit('close')\"\r\n        >\r\n            <div class=\"mb-xs fz-xs title-text-block\">\r\n                <span>{{ typeText }}单号：{{ stockTrans.number }}</span>\r\n                <span>订单号：{{ stockTrans.number }}</span>\r\n                <span>源货架：\r\n                    <el-tooltip\r\n                            class=\"item\"\r\n                            effect=\"dark\"\r\n                            :content=\"stockText(stockTrans,false)\"\r\n                            placement=\"bottom\"\r\n                    >\r\n                        <el-tag type=\"info\" class=\"cursor-p\">{{stockTrans.stockName}}</el-tag>\r\n                    </el-tooltip>\r\n                </span>\r\n                <span>目标货架：\r\n                    <el-tooltip\r\n                            class=\"item\"\r\n                            effect=\"dark\"\r\n                            :content=\"stockText(stockTrans,true)\"\r\n                            placement=\"bottom\"\r\n                    >\r\n                        <el-tag type=\"success\" class=\"cursor-p\">{{stockTrans.stockNameTo}}</el-tag>\r\n                    </el-tooltip>\r\n                </span>\r\n            </div>\r\n            <div class=\"mb-xs\">\r\n                <el-button-curd-group\r\n                        slot=\"buttons\"\r\n                        :add-disabled=\"!canEdit\"\r\n                        :delete-disabled=\"!selectedRow.length || !canEdit\"\r\n                        :edit-disabled=\"selectedRow.length !== 1 || !canEdit\"\r\n                        @click-add=\"clickAddButton\"\r\n                        @click-edit=\"clickEditButton\"\r\n                        @click-delete=\"clickDeleteButton\"\r\n                ></el-button-curd-group>\r\n            </div>\r\n            <div class=\"\">\r\n                <table-panel\r\n                        :loading=\"loading\"\r\n                        :data=\"data\"\r\n                        operate-width=\"80\"\r\n                        :selectedRow.sync=\"selectedRow\"\r\n                        :create-user-show=\"true\"\r\n                        :update-user-show=\"true\"\r\n                        :show-all-warehouse=\"false\"\r\n                        :show-paginate=\"false\"\r\n                        :fix-height=\"360\"\r\n                        :sortable=\"null\"\r\n                        :show-index=\"false\"\r\n                        ref=\"table\"\r\n                >\r\n                    <el-table-column\r\n                            prop=\"materialName\"\r\n                            label=\"物品名称\"\r\n                            width=\"160\"\r\n                    ></el-table-column>\r\n\r\n                    <el-table-column\r\n                            prop=\"quantity\"\r\n                            label=\"实际数量\"\r\n                            width=\"100\"\r\n                    ></el-table-column>\r\n\r\n                    <el-table-column\r\n                            prop=\"materialUnitName\"\r\n                            label=\"单位\"\r\n                            width=\"70\"\r\n                    ></el-table-column>\r\n\r\n                    <el-table-column\r\n                            prop=\"stockId\"\r\n                            label=\"源货架\"\r\n                            width=\"120\"\r\n                    >\r\n                        <template slot-scope=\"{row}\">\r\n                            <el-tooltip\r\n                                    class=\"item\"\r\n                                    effect=\"dark\"\r\n                                    :content=\"stockText(row,false)\"\r\n                                    placement=\"top\">\r\n                                <span class=\"cursor-p\">{{row.stockName}}</span>\r\n                            </el-tooltip>\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <el-table-column\r\n                            prop=\"stockTid\"\r\n                            label=\"目标货架\"\r\n                            width=\"120\"\r\n                    >\r\n                        <template slot-scope=\"{row}\">\r\n                            <el-tooltip\r\n                                    class=\"item\"\r\n                                    effect=\"dark\"\r\n                                    :content=\"stockText(row,true)\"\r\n                                    placement=\"top\">\r\n                                <span class=\"cursor-p\">{{row.stockNameTo}}</span>\r\n                            </el-tooltip>\r\n                        </template>\r\n                    </el-table-column>\r\n\r\n                    <template slot=\"operate\" slot-scope=\"{row}\">\r\n                        <el-button-mini\r\n                                type=\"text\"\r\n                                icon=\"edit\"\r\n                                @click.native=\"clickRowEditButton(row)\"\r\n                                v-if=\"canEdit\"\r\n                        ></el-button-mini>\r\n                        <el-button-mini\r\n                                type=\"text\"\r\n                                icon=\"delete\"\r\n                                @click.native=\"clickRowDeleteButton(row)\"\r\n                                v-if=\"canEdit\"\r\n                        ></el-button-mini>\r\n                    </template>\r\n                </table-panel>\r\n            </div>\r\n\r\n        </el-dialog>\r\n        <trans-move-add-dialog\r\n                :visible.sync=\"showAddDialog\"\r\n                :edit-id=\"editId\"\r\n                :type=\"type\"\r\n                :stock-trans=\"stockTrans\"\r\n                @finish=\"refreshData\"\r\n        ></trans-move-add-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import TablePanel from \"@/components/layout-component/TablePanel\";\r\n    import ElButtonMini from \"@/components/common/button/ElButtonMini\";\r\n    import Api from \"@/assets/api/Api\";\r\n    import ElButtonCurdGroup from \"@/components/common/button/ElButtonCurdGroup\";\r\n    import DialogUtil from \"@/util/DialogUtil\";\r\n    import MoveAddDialog from \"@/components/page-content/stock-entry/dialog/MoveAddDialog\";\r\n    import StockTransModel from \"@/project/model/StockTransModel\";\r\n    import TransMoveAddDialog from \"@/components/page-content/stock-trans/dialog/TransMoveAddDialog\";\r\n\r\n    export default {\r\n        name: \"TransMoveListDialog\",\r\n        components: {TransMoveAddDialog, MoveAddDialog, ElButtonCurdGroup, ElButtonMini, TablePanel},\r\n        props: {\r\n            visible: {\r\n                default: false\r\n            },\r\n            stockTrans: {\r\n                default() {\r\n                    return new StockTransModel();\r\n                }\r\n            },\r\n            type: {\r\n                default: 1\r\n            }\r\n        },\r\n        data() {\r\n            return {\r\n                loading: false,\r\n                showAddDialog: false,\r\n                data: [],\r\n                selectedRow: [],\r\n                editId: 0,\r\n            }\r\n        },\r\n        mounted() {\r\n            this.reload();\r\n        },\r\n        methods: {\r\n            reload() {\r\n            },\r\n            showDialog(v) {\r\n                this.$emit(\"update:visible\", v);\r\n            },\r\n            refreshData() {\r\n                this.loading = true;\r\n                this.$ajax.request(Api.move.selectByStockTransId, {\r\n                    stockTransId: this.stockTrans.id\r\n                }).then(resp => {\r\n                    this.data = resp;\r\n                }).finally(() => this.loading = false)\r\n            },\r\n\r\n            clickAddButton() {\r\n                this.editId = 0;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickEditButton() {\r\n                this.editId = this.selectedRow[0].id;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickDeleteButton() {\r\n                this.delete(this.selectedRow);\r\n            },\r\n            clickRowEditButton(row) {\r\n                this.editId = row.id;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickRowDeleteButton(row) {\r\n                this.delete([row]);\r\n            },\r\n            delete(nodes) {\r\n                DialogUtil.confirm(`\r\n                    确定删除以下${this.typeText}信息吗？ <br>\r\n                    [ ${nodes.map(x => x.materialName).join(',')} ]\r\n                `).then(() => {\r\n                    return this.$ajax.request(Api.move.delete, {\r\n                        ids: nodes.map(x => x.id).join(',')\r\n                    });\r\n                }).then(resp => {\r\n                    DialogUtil.toastSuccess(resp);\r\n                    this.refreshData();\r\n                })\r\n            },\r\n            stockText(row, isTo = false) {\r\n                let k = isTo ? 'To' : '';\r\n                return [\r\n                    row['warehouseCode' + k],\r\n                    row['reservoirCode' + k],\r\n                    row['stockCode' + k] + `(${row['stockName' + k]})`\r\n                ].join(' / ');\r\n            },\r\n        },\r\n        watch: {\r\n            visible(v) {\r\n                if (v) {\r\n                    this.refreshData();\r\n                }\r\n            }\r\n        },\r\n        computed: {\r\n            title() {\r\n                return `${this.typeText}单明细 ${this.stockTrans.number}`\r\n            },\r\n            typeText() {\r\n                return \"移位\";\r\n            },\r\n            canEdit() {\r\n                return [1, 4].includes(this.stockTrans.status);\r\n            }\r\n        },\r\n\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    @import (reference) \"~style/all.less\";\r\n\r\n    .TransMoveListDialog {\r\n    }\r\n</style>"],"sourceRoot":"src/components/page-content/stock-trans/dialog"}]}
{"remainingRequest":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\项目\\SKWMS\\wms-ui\\src\\components\\page-content\\warehouse\\StockManagerView.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\项目\\SKWMS\\wms-ui\\src\\components\\page-content\\warehouse\\StockManagerView.vue","mtime":1585370816000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\项目\\SKWMS\\wms-ui\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport SearchCardLayout from \"@/components/layout-component/SearchCardLayout\";\nimport DialogUtil from \"@/util/DialogUtil\";\nimport Api from \"@/assets/api/Api\";\nimport EcUtil from \"@/util/EcUtil\";\nimport ElButtonCurdGroup from \"@/components/common/button/ElButtonCurdGroup\";\nimport StockModel from \"@/project/model/StockModel\";\nimport PaginateModel from \"@/project/model/PaginateModel\";\nimport WarehouseSelector from \"@/components/page-content/enum-selector/WarehouseSelector\";\nimport ElButtonMini from \"@/components/common/button/ElButtonMini\";\nimport TablePanel from \"@/components/layout-component/TablePanel\";\nimport StockAddDialog from \"@/components/page-content/warehouse/dialog/StockAddDialog\";\n\nexport default {\n    name: \"StockManagerView\",\n    components: {StockAddDialog, TablePanel, ElButtonMini, WarehouseSelector, ElButtonCurdGroup, SearchCardLayout},\n    props: {},\n    data() {\n        return {\n            loading: false,\n            showAddDialog: false,\n            filterForm: new StockModel(),\n            data: [],\n            paginate: new PaginateModel(this.refreshData),\n            selectedRow: [],\n            sortingColumn: null,\n            editId: 0,\n        }\n    },\n    mounted() {\n        this.reload();\n    },\n    methods: {\n        reload() {\n            this.refreshData();\n        },\n        refreshData() {\n            this.loading = true;\n            this.$ajax.request(Api.warehouse.stockList, {\n                ...EcUtil.getSortField(this.sortingColumn),\n                ...this.paginate.getJSON(),\n                ...this.filterForm\n            }).then(resp => {\n                this.data = resp.list;\n                this.paginate.setPaginate(resp);\n            }).finally(() => this.loading = false)\n        },\n\n        sortChange(nodes) {\n            this.sortingColumn = nodes;\n            this.refreshData();\n        },\n\n        clickAddButton() {\n            this.editId = 0;\n            this.showAddDialog = true;\n        },\n        clickEditButton() {\n            this.editId = this.selectedRow[0].id;\n            this.showAddDialog = true;\n        },\n        clickDeleteButton() {\n            this.delete(this.selectedRow);\n        },\n        clickRowEditButton(row) {\n            this.editId = row.id;\n            this.showAddDialog = true;\n        },\n        clickRowDeleteButton(row) {\n            this.delete([row]);\n        },\n        delete(nodes) {\n            DialogUtil.confirm(`\n                确定删除以下货架吗？ <br>\n                [ ${nodes.map(x => x.name).join(',')} ]\n            `).then(() => {\n                return this.$ajax.request(Api.warehouse.stockDelete, {\n                    ids: nodes.map(x => x.id).join(',')\n                });\n            }).then(resp => {\n                DialogUtil.toastSuccess(resp);\n                this.refreshData();\n            })\n        },\n        warehouseSelectorChange(routeIds) {\n            switch (routeIds.length) {\n                case 0 :\n                    this.filterForm.warehouseId = 0;\n                    this.filterForm.reservoirId = 0;\n                    break;\n                case 1:\n                    this.filterForm.warehouseId = routeIds[0];\n                    this.filterForm.reservoirId = 0;\n                    break;\n                case 2:\n                    this.filterForm.warehouseId = routeIds[0];\n                    this.filterForm.reservoirId = routeIds[1];\n                    break;\n                default:\n                    this.filterForm.warehouseId = 0;\n                    this.filterForm.reservoirId = 0;\n                    break;\n            }\n        }\n    },\n    watch: {},\n    computed: {},\n\n}\n",{"version":3,"sources":["StockManagerView.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"StockManagerView.vue","sourceRoot":"src/components/page-content/warehouse","sourcesContent":["<template>\r\n    <div class=\"StockManagerView flex-box flex-column\">\r\n        <search-card-layout\r\n                @click-search=\"refreshData\"\r\n                :loading=\"loading\"\r\n        >\r\n            <div class=\"flex-box search-card\">\r\n                <div class=\"\">\r\n                    <span>货架编号</span>\r\n                    <el-input v-model=\"filterForm.code\"></el-input>\r\n                </div>\r\n                <div class=\"\">\r\n                    <span>货架名称</span>\r\n                    <el-input v-model=\"filterForm.name\"></el-input>\r\n                </div>\r\n                <div class=\"\">\r\n                    <span>所属位置</span>\r\n                    <warehouse-selector\r\n                            width=\"300px\"\r\n                            :level=\"2\"\r\n                            @change=\"warehouseSelectorChange\"\r\n                            :is-filter=\"true\"\r\n                    ></warehouse-selector>\r\n                </div>\r\n            </div>\r\n            <el-button-curd-group\r\n                    slot=\"buttons\"\r\n                    :delete-disabled=\"!selectedRow.length\"\r\n                    :edit-disabled=\"selectedRow.length !== 1\"\r\n                    @click-add=\"clickAddButton\"\r\n                    @click-edit=\"clickEditButton\"\r\n                    @click-delete=\"clickDeleteButton\"\r\n            ></el-button-curd-group>\r\n        </search-card-layout>\r\n\r\n        <div class=\"flex-grow\">\r\n            <table-panel\r\n                    :loading=\"loading\"\r\n                    :data=\"data\"\r\n                    :paginate=\"paginate\"\r\n                    operate-width=\"80\"\r\n                    :selectedRow.sync=\"selectedRow\"\r\n                    @sort-change=\"sortChange\"\r\n                    :create-user-show=\"true\"\r\n                    :update-user-show=\"true\"\r\n            >\r\n                <el-table-column\r\n                        prop=\"id\"\r\n                        label=\"ID\"\r\n                        sortable=\"custom\"\r\n                        width=\"80\"\r\n                ></el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"code\"\r\n                        label=\"货架编号\"\r\n                        sortable=\"custom\"\r\n                        width=\"120\"\r\n                ></el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"name\"\r\n                        label=\"货架名称\"\r\n                        sortable=\"custom\"\r\n                        width=\"160\"\r\n                ></el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"warehouseId\"\r\n                        label=\"所属仓库\"\r\n                        sortable=\"custom\"\r\n                        width=\"160\"\r\n                >\r\n                    <template slot-scope=\"{row}\">{{ row.warehouseName }}</template>\r\n                </el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"reservoirId\"\r\n                        label=\"所属仓位\"\r\n                        sortable=\"custom\"\r\n                        width=\"160\"\r\n                >\r\n                    <template slot-scope=\"{row}\">{{ row.reservoirName }}</template>\r\n                </el-table-column>\r\n\r\n                <el-table-column\r\n                        prop=\"remark\"\r\n                        label=\"备注\"\r\n                        :show-overflow-tooltip=\"true\"\r\n                        sortable=\"custom\"\r\n                        width=\"200\"\r\n                ></el-table-column>\r\n\r\n                <template slot=\"operate\" slot-scope=\"{row}\">\r\n                    <el-button-mini\r\n                            type=\"text\"\r\n                            icon=\"edit\"\r\n                            @click.native=\"clickRowEditButton(row)\"\r\n                    ></el-button-mini>\r\n                    <el-button-mini\r\n                            type=\"text\"\r\n                            icon=\"delete\"\r\n                            @click.native=\"clickRowDeleteButton(row)\"\r\n                    ></el-button-mini>\r\n                </template>\r\n            </table-panel>\r\n        </div>\r\n\r\n        <stock-add-dialog\r\n            :edit-id=\"editId\"\r\n            @finish=\"refreshData\"\r\n            :visible.sync=\"showAddDialog\"\r\n        ></stock-add-dialog>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import SearchCardLayout from \"@/components/layout-component/SearchCardLayout\";\r\n    import DialogUtil from \"@/util/DialogUtil\";\r\n    import Api from \"@/assets/api/Api\";\r\n    import EcUtil from \"@/util/EcUtil\";\r\n    import ElButtonCurdGroup from \"@/components/common/button/ElButtonCurdGroup\";\r\n    import StockModel from \"@/project/model/StockModel\";\r\n    import PaginateModel from \"@/project/model/PaginateModel\";\r\n    import WarehouseSelector from \"@/components/page-content/enum-selector/WarehouseSelector\";\r\n    import ElButtonMini from \"@/components/common/button/ElButtonMini\";\r\n    import TablePanel from \"@/components/layout-component/TablePanel\";\r\n    import StockAddDialog from \"@/components/page-content/warehouse/dialog/StockAddDialog\";\r\n\r\n    export default {\r\n        name: \"StockManagerView\",\r\n        components: {StockAddDialog, TablePanel, ElButtonMini, WarehouseSelector, ElButtonCurdGroup, SearchCardLayout},\r\n        props: {},\r\n        data() {\r\n            return {\r\n                loading: false,\r\n                showAddDialog: false,\r\n                filterForm: new StockModel(),\r\n                data: [],\r\n                paginate: new PaginateModel(this.refreshData),\r\n                selectedRow: [],\r\n                sortingColumn: null,\r\n                editId: 0,\r\n            }\r\n        },\r\n        mounted() {\r\n            this.reload();\r\n        },\r\n        methods: {\r\n            reload() {\r\n                this.refreshData();\r\n            },\r\n            refreshData() {\r\n                this.loading = true;\r\n                this.$ajax.request(Api.warehouse.stockList, {\r\n                    ...EcUtil.getSortField(this.sortingColumn),\r\n                    ...this.paginate.getJSON(),\r\n                    ...this.filterForm\r\n                }).then(resp => {\r\n                    this.data = resp.list;\r\n                    this.paginate.setPaginate(resp);\r\n                }).finally(() => this.loading = false)\r\n            },\r\n\r\n            sortChange(nodes) {\r\n                this.sortingColumn = nodes;\r\n                this.refreshData();\r\n            },\r\n\r\n            clickAddButton() {\r\n                this.editId = 0;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickEditButton() {\r\n                this.editId = this.selectedRow[0].id;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickDeleteButton() {\r\n                this.delete(this.selectedRow);\r\n            },\r\n            clickRowEditButton(row) {\r\n                this.editId = row.id;\r\n                this.showAddDialog = true;\r\n            },\r\n            clickRowDeleteButton(row) {\r\n                this.delete([row]);\r\n            },\r\n            delete(nodes) {\r\n                DialogUtil.confirm(`\r\n                    确定删除以下货架吗？ <br>\r\n                    [ ${nodes.map(x => x.name).join(',')} ]\r\n                `).then(() => {\r\n                    return this.$ajax.request(Api.warehouse.stockDelete, {\r\n                        ids: nodes.map(x => x.id).join(',')\r\n                    });\r\n                }).then(resp => {\r\n                    DialogUtil.toastSuccess(resp);\r\n                    this.refreshData();\r\n                })\r\n            },\r\n            warehouseSelectorChange(routeIds) {\r\n                switch (routeIds.length) {\r\n                    case 0 :\r\n                        this.filterForm.warehouseId = 0;\r\n                        this.filterForm.reservoirId = 0;\r\n                        break;\r\n                    case 1:\r\n                        this.filterForm.warehouseId = routeIds[0];\r\n                        this.filterForm.reservoirId = 0;\r\n                        break;\r\n                    case 2:\r\n                        this.filterForm.warehouseId = routeIds[0];\r\n                        this.filterForm.reservoirId = routeIds[1];\r\n                        break;\r\n                    default:\r\n                        this.filterForm.warehouseId = 0;\r\n                        this.filterForm.reservoirId = 0;\r\n                        break;\r\n                }\r\n            }\r\n        },\r\n        watch: {},\r\n        computed: {},\r\n\r\n    }\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n    @import (reference) \"~style/all.less\";\r\n\r\n    .StockManagerView {\r\n    }\r\n</style>"]}]}